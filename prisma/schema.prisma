generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "sqlite"
    url      = "file:./dev.db"
}

model User {
    id     String         @id @default(uuid())
    email  String      @unique
    name   String
    goals  Goal[]
    groups UserGroup[]
}

model Goal {
    id          String              @id @default(uuid())
    description String
    completed   Boolean          @default(false)
    user        User             @relation(fields: [userId], references: [id])
    userId      String
    groups      UserGroupGoals[]
    commits     Commit[]
}

model Commit {
    id          String      @id @default(uuid())
    createdAt   DateTime @default(now())
    description String?
    hours       Float?
    goal        Goal     @relation(fields: [goalId], references: [id])
    goalId      String
}

model Group {
    id    String         @id @default(uuid())
    name  String
    users UserGroup[]
}

model UserGroup {
    user    User             @relation(fields: [userId], references: [id])
    userId  String
    group   Group            @relation(fields: [groupId], references: [id])
    groupId String
    goals   UserGroupGoals[]

    @@id([userId, groupId])
}

model UserGroupGoals {
    userGroup UserGroup @relation(fields: [userId, groupId], references: [userId, groupId])
    userId    String
    groupId   String
    goal      Goal      @relation(fields: [goalId], references: [id])
    goalId    String

    @@id([groupId, goalId])
}
